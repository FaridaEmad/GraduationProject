<div class="booking-management-container">
  <div class="page-header">
    <div class="header-content">
      <div class="title-wrapper">
        <div class="title-icon">
          <i class="bi bi-calendar-check"></i>
        </div>
        <div class="title-text">
          <h1 class="page-title">Booking Management</h1>
          <p class="page-subtitle">Manage and monitor booking appointments</p>
        </div>
      </div>
    </div>
  </div>

  <div class="filters-section">
    <div class="row g-3">
      <div class="col-12 col-md-4">
        <div class="search-box">
          <i class="bi bi-search search-icon"></i>
          <input 
            type="text" 
            class="form-control search-input" 
            placeholder="Search by email, description..." 
            [(ngModel)]="searchTerm" 
            (input)="applyFilters()"
          >
        </div>
      </div>
    </div>
  </div>

  <div class="table-card">
    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>User Email</th>
            <th>Offer Description</th>
            <th>Quantity</th>
            <th>Booking Date</th>
            <th class="actions-column">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let booking of paginatedBookings">
            <td>{{ booking.bookingId }}</td>
            <td>{{ getUserEmail(booking) }}</td>
    <td>{{ getOfferDescription(booking) }}</td>
            <td>{{ booking.quantity }}</td>
            <td>{{ booking.bookingDate }}</td>
            <td class="actions-cell">
              <div class="action-buttons">
                <button 
                  class="btn btn-warning" 
                  (click)="openEditModal(booking)"
                  title="Edit Booking"
                >
                  <i class="bi bi-pencil"></i>
                </button>
                <button 
                  class="btn btn-danger" 
                  (click)="deleteBooking(booking.bookingId)"
                  title="Delete Booking"
                >
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
          <tr *ngIf="paginatedBookings.length === 0">
            <td colspan="6" class="text-center py-4">
              <div class="no-data-message">
                <i class="bi bi-calendar-x no-data-icon"></i>
                <p class="no-data-text">No bookings found</p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination-wrapper" *ngIf="totalPages > 1">
      <div class="pagination-info">
        Showing {{ (currentPage - 1) * itemsPerPage + 1 }} to {{ Math.min(currentPage * itemsPerPage, filteredBookings.length) }} of {{ filteredBookings.length }} entries
      </div>
      <div class="pagination-controls">
        <button 
          class="btn btn-pagination" 
          [disabled]="currentPage === 1"
          (click)="changePage(1)"
          title="First Page"
        >
          <i class="bi bi-chevron-double-left"></i>
        </button>
        <button 
          class="btn btn-pagination" 
          [disabled]="currentPage === 1"
          (click)="changePage(currentPage - 1)"
          title="Previous Page"
        >
          <i class="bi bi-chevron-left"></i>
        </button>
        
        <div class="page-numbers">
          <ng-container *ngFor="let page of getPageNumbers()">
            <button 
              *ngIf="page > 0"
              class="btn btn-pagination"
              [class.active]="page === currentPage"
              (click)="changePage(page)"
            >
              {{ page }}
            </button>
            <span *ngIf="page < 0" class="pagination-ellipsis">...</span>
          </ng-container>
        </div>

        <button 
          class="btn btn-pagination" 
          [disabled]="currentPage === totalPages"
          (click)="changePage(currentPage + 1)"
          title="Next Page"
        >
          <i class="bi bi-chevron-right"></i>
        </button>
        <button 
          class="btn btn-pagination" 
          [disabled]="currentPage === totalPages"
          (click)="changePage(totalPages)"
          title="Last Page"
        >
          <i class="bi bi-chevron-double-right"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Booking Modal -->
  <dialog #bookingModal class="modal-dialog rounded-2">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Booking Quantity</h5>
        <button type="button" class="btn-close" (click)="closeModal()"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()" class="booking-form">
          <div class="row g-3">
            <div class="col-12">
              <div class="form-group">
                <label class="form-label">Quantity</label>
                <input 
                  type="number" 
                  class="form-control" 
                  formControlName="quantity"
                  min="1"
                >
              </div>
            </div>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-light" (click)="closeModal()">Cancel</button>
            <button type="submit" class="btn btn-primary" [disabled]="bookingForm.invalid">
              Update Quantity
            </button>
          </div>
        </form>
      </div>
    </div>
  </dialog>
</div>