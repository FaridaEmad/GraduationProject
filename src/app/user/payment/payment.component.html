<!-- Payment Page Container -->
<div *ngIf="!showSuccessScreen" class="payment-container">
  <div class="particle particle1"></div>
  <div class="particle particle2"></div>
  <div class="particle particle3"></div>
  <div class="particle particle4"></div>
  <div class="particle particle5"></div>
  <div class="brand-logo">
    <img src="assets/logo.png" alt="Brand Logo" />
  </div>
  <div class="payment-card">
    <div class="payment-header">
      <h2>Pay with card</h2>
      <div class="total-amount">
        Total: <strong>EGP {{ totalAmount }}</strong>
      </div>
    </div>

    <form [formGroup]="paymentForm" (ngSubmit)="pay()" class="payment-form">
      <!-- Email Field -->
      <div class="form-group">
        <label for="email">Email Address</label>
        <div class="input-group">
          <i class="fas fa-envelope animated-icon"></i>
          <input 
            id="email"
            formControlName="email" 
            type="email" 
            placeholder="Enter your email"
            aria-label="Email Address"
            [class.is-invalid]="paymentForm.get('email')?.invalid && paymentForm.get('email')?.touched"
          />
        </div>
      </div>

      <!-- Card Number Field -->
      <div class="form-group">
        <label for="cardNumber">Card Number</label>
        <div class="input-group">
          <i class="fas fa-credit-card animated-icon"></i>
          <input 
            id="cardNumber"
            formControlName="cardNumber" 
            placeholder="1234 5678 9012 3456"
            aria-label="Card Number"
            [class.is-invalid]="paymentForm.get('cardNumber')?.invalid && paymentForm.get('cardNumber')?.touched"
          />
        </div>
      </div>

      <!-- Expiry and CVC Fields -->
      <div class="form-row">
        <div class="form-group">
          <label for="expiry">Expiry Date</label>
          <div class="input-group">
            <i class="fas fa-calendar animated-icon"></i>
            <input 
              id="expiry"
              formControlName="expiry" 
              placeholder="MM / YY"
              aria-label="Expiry Date"
              [class.is-invalid]="paymentForm.get('expiry')?.invalid && paymentForm.get('expiry')?.touched"
            />
          </div>
        </div>

        <div class="form-group">
          <label for="cvc">CVC</label>
          <div class="input-group">
            <i class="fas fa-lock animated-icon"></i>
            <input 
              id="cvc"
              formControlName="cvc" 
              placeholder="123"
              aria-label="CVC"
              [class.is-invalid]="paymentForm.get('cvc')?.invalid && paymentForm.get('cvc')?.touched"
            />
          </div>
        </div>
      </div>

      <!-- Name on Card Field -->
      <div class="form-group">
        <label for="nameOnCard">Name on Card</label>
        <div class="input-group">
          <i class="fas fa-user animated-icon"></i>
          <input 
            id="nameOnCard"
            formControlName="nameOnCard" 
            placeholder="John Doe"
            aria-label="Name on Card"
            [class.is-invalid]="paymentForm.get('nameOnCard')?.invalid && paymentForm.get('nameOnCard')?.touched"
          />
        </div>
      </div>

      <!-- Country Selection -->
      <div class="form-group">
        <label for="country">Country</label>
        <div class="input-group">
          <i class="fas fa-globe animated-icon"></i>
          <select 
            id="country"
            formControlName="country" 
            class="form-select"
            aria-label="Country"
          >
            <option value="Egypt">Egypt</option>
            <option value="USA">United States</option>
            <option value="UK">United Kingdom</option>
          </select>
        </div>
      </div>

      <!-- Payment Method Selection -->
      <div class="form-group">
        <label for="methodId">Payment Method</label>
        <div class="input-group">
          <i class="fas fa-money-bill-wave animated-icon"></i>
          <select 
            id="methodId"
            formControlName="methodId" 
            class="form-select"
            aria-label="Payment Method"
            required
          >
            <option value="" >Select a payment method</option>
            <option *ngFor="let method of paymentMethods" [value]="method.paymentMethodId">
              {{ method.method }}
            </option>
          </select>
        </div>
      </div>

      <!-- Submit Button -->
      <button 
        type="submit" 
        class="submit-button" 
        [disabled]="paymentForm.invalid || isProcessing"
        [class.loading]="isProcessing"
        aria-label="Pay Now"
        #payBtn
        (click)="triggerRipple(payBtn)"
      >
        <span *ngIf="!isProcessing">Pay Now</span>
        <span *ngIf="isProcessing" class="spinner"></span>
        <span class="ripple"></span>
      </button>
    </form>
  </div>
  
</div>

<!-- Success Screen -->
<div *ngIf="showSuccessScreen" class="success-screen">
  <div class="success-content">
    <div class="success-icon">âœ“</div>
    <h2>Payment Successful!</h2>
    <p>Your payment has been processed successfully.</p>
    <p>Redirecting to payments page...</p>
  </div>
</div>

